pc1 <- predict(pca_floracio)[,1] #PC1
pc2 <- predict(pca_floracio)[,2] #PC2
# biplot(pca_floracio)
xfloracio <- cbind(xfloracio, pc1, pc2)
#PC1
plot(x=xfloracio$pc1,type="n", y=xfloracio$FL_prunus.dulcis, ylim=c(min(xfloracio[,2:8]),max(xfloracio[,2:8])), main="Resposta floracio")
points(x=xfloracio$pc1, y=xfloracio$FL_prunus.dulcis, pch = 16, col=c("black"))
points(x=xfloracio$pc1, y=xfloracio$FL_prunus.armeniaca, pch = 16, col=c("blue"))
points(x=xfloracio$pc1, y=xfloracio$FL_cydonia.oblonga, pch = 16, col=c("orange"))
points(x=xfloracio$pc1, y=xfloracio$FL_malus.domestica, pch = 16, col=c("red"))
points(x=xfloracio$pc1, y=xfloracio$FL_citrus.sinensis, pch = 16, col=c("yellow"))
points(x=xfloracio$pc1, y=xfloracio$FL_juglans.regia, pch = 16, col=c("brown"))
points(x=xfloracio$pc1, y=xfloracio$FL_vitis.vinifera, pch = 16, col=c("purple"))
#PC2
plot(x=xfloracio$pc2,type="n", y=xfloracio$FL_prunus.dulcis, ylim=c(min(xfloracio[,2:8]),max(xfloracio[,2:8])), main="Resposta floracio")
points(x=xfloracio$pc2, y=xfloracio$FL_prunus.dulcis, pch = 16, col=c("black"))
install.packages("stats")
install.packages("stats")
install.packages("stats")
install.packages("stats")
install.packages("stats")
install.packages("stats")
install.packages("stats")
install.packages("stats")
setwd("C:/Users/Usuario/Desktop/PAUP")
df <- cbind(data, prcomp$x[,1:2])
ggplot(df, aes(PC1, PC2, col = data[,num], fill = data[,num])) +
stat_ellipse(geom="polygon", col="black", alpha = .4, type="norm") +
geom_point(shape=21, col ="black")
PCA <- function(data, num){
data <- data[,-num]
prcomp <- prcomp(data, center = TRUE,scale. = TRUE)
install.packages("ggplot2")
library(ggplot2)
df <- cbind(data, prcomp$x[,1:2])
ggplot(df, aes(PC1, PC2, col = data[,num], fill = data[,num])) +
stat_ellipse(geom="polygon", col="black", alpha = .4, type="norm") +
geom_point(shape=21, col ="black")
}
PCA <- function(data, num){
data <- data[,-1]
prcomp <- prcomp(data, center = TRUE,scale. = TRUE)
install.packages("ggplot2")
library(ggplot2)
df <- cbind(data, prcomp$x[,1:2])
ggplot(df, aes(PC1, PC2, col = data[,num], fill = data[,num])) +
stat_ellipse(geom="polygon", col="black", alpha = .4, type="norm") +
geom_point(shape=21, col ="black")
}
PCA <- function(data, num){
data <- data[,-1]
prcomp <- prcomp(data, center = TRUE,scale. = TRUE)
install.packages("ggplot2")
library(ggplot2)
df <- cbind(data, prcomp$x[,1:2])
ggplot(df, aes(PC1, PC2, col = data[,num], fill = data[,num])) +
stat_ellipse(geom="polygon", col="black", alpha = .4, type="norm") +
geom_point(shape=21, col ="black")
}
View(PCA)
data <- dades.txt
PCA <- function(data, 1)
data <- opent("dades.txt")
PCA <- function(data, 1)
data <- (alex	110100021210002211010011002010
willy	220220022022202221121022102020
albert	010111221100111112211012202000
ricardo	120200022222202120221202021201
jan	110102012221001111120012102010
roger	110220012221102121120002002211
miquelonis	122221222221222122122122122222
miquel	011211222210200021221212121220
ada	120111022221112211211222101000
marian	011221022120111221022202222220
raul	220202122211202110122122201202
oriol	020102022221112221020102002011
martí	020202022120101010021122001001
biel	210100012221102010110111022210
adria	222122002222112221121211102220
lucía	012222222220112212222220022220
roger	120200012222111222221012022120
inés	120221122211220122222122101021
júlia	120201022221211121221212002200
grigri	020222222222222022220211002220
ramón	010212222021102101121211022221
rubèn	212212202221102120121122002221
patri	221220212120201022222211002020
)
PCA <- function(data, 1)
data <- read.table(file = "mi_archivo.txt", header = TRUE)
data <- read.table(file = "dades.txt", header = TRUE)
head(data)
PCA <- function(data, 1)
PCA
PCA <- function(data, 1){
data <- data[,-1]
prcomp <- prcomp(data, center = TRUE,scale. = TRUE)
install.packages("ggplot2")
library(ggplot2)
PCA <- function(data, 1){
data <- data[,-1]
prcomp <- prcomp(data, center = TRUE,scale. = TRUE)
install.packages("ggplot2")
library(ggplot2)
df <- cbind(data, prcomp$x[,1:2])
ggplot(df, aes(PC1, PC2, col = data[,num], fill = data[,num])) +
stat_ellipse(geom="polygon", col="black", alpha = .4, type="norm") +
geom_point(shape=21, col ="black")
}
install.packages("ggplot2")
data <- read.table(file = "dades.txt", header = TRUE)
head(data)
PCA
PCA
View(PCA)
View(PCA)
View(PCA)
View(PCA)
View(PCA)
View(PCA)
ggplot(df, aes(PC1, PC2, col = data[,num], fill = data[,num])) +
stat_ellipse(geom="polygon", col="black", alpha = .4, type="norm") +
geom_point(shape=21, col ="black")
PCA <- function(data, 1){
data <- data[,-1]
prcomp <- prcomp(data, center = TRUE,scale. = TRUE)
library(ggplot2)
df <- cbind(data, prcomp$x[,1:2])
ggplot(df, aes(PC1, PC2, col = data[,num], fill = data[,num])) +
stat_ellipse(geom="polygon", col="black", alpha = .4, type="norm") +
geom_point(shape=21, col ="black")
}
data <- data[,-1]
prcomp <- prcomp(data, center = TRUE,scale. = TRUE)
library(ggplot2)
df <- cbind(data, prcomp$x[,1:2])
ggplot(df, aes(PC1, PC2, col = data[,num], fill = data[,num])) +
stat_ellipse(geom="polygon", col="black", alpha = .4, type="norm") +
geom_point(shape=21, col ="black")
PCA <- function(data, 1){
data <- data[,-1]
prcomp <- prcomp(data, center = TRUE,scale. = TRUE)
library(ggplot2)
df <- cbind(data, prcomp$x[,1:2])
ggplot(df, aes(PC1, PC2, col = data[,num], fill = data[,num])) +
stat_ellipse(geom="polygon", col="black", alpha = .4, type="norm") +
geom_point(shape=21, col ="black")
}
PCA <- function(x, 1){
data <- data[,-1]
prcomp <- prcomp(data, center = TRUE,scale. = TRUE)
library(ggplot2)
df <- cbind(data, prcomp$x[,1:2])
ggplot(df, aes(PC1, PC2, col = data[,num], fill = data[,num])) +
stat_ellipse(geom="polygon", col="black", alpha = .4, type="norm") +
geom_point(shape=21, col ="black")
}
PCA <- function(data, num){
data <- data[,-1]
prcomp <- prcomp(data, center = TRUE,scale. = TRUE)
library(ggplot2)
df <- cbind(data, prcomp$x[,1:2])
ggplot(df, aes(PC1, PC2, col = data[,num], fill = data[,num])) +
stat_ellipse(geom="polygon", col="black", alpha = .4, type="norm") +
geom_point(shape=21, col ="black")
}
x <- read.table(file = "dades.txt", header = TRUE)
head(data)
PCA(x,1)
x <- read.table(file = "dades.txt", header = TRUE)
head(x)
x <- read.table(file = "dades.txt", header = TRUE)
head(x)
## now make a fancy looking plot that shows the PCs and the variation:
library(ggplot2)
pca.data <- data.frame(Sample=rownames(pca$x),
X=pca$x[,1],
Y=pca$x[,2])
x <- read.table(file = "dades.txt", header = TRUE)
head(x)
dades <- read.delim("C:/Users/Usuario/Desktop/PAUP/dades.txt", header=FALSE)
View(dades)
pca.data <- data.frame(Sample=rownames(pca$x),
X=pca$x[,1],
Y=pca$x[,2])
pca.data
ggplot(data=pca.data, aes(x=X, y=Y, label=Sample)) +
geom_text() +
xlab(paste("PC1 - ", pca.var.per[1], "%", sep="")) +
ylab(paste("PC2 - ", pca.var.per[2], "%", sep="")) +
theme_bw() +
ggtitle("My PCA Graph")
pca.data <- dades
pca.data
ggplot(data=pca.data, aes(x=X, y=Y, label=Sample)) +
geom_text() +
xlab(paste("PC1 - ", pca.var.per[1], "%", sep="")) +
ylab(paste("PC2 - ", pca.var.per[2], "%", sep="")) +
theme_bw() +
ggtitle("My PCA Graph")
ggplot(data=pca.data, aes(x=X, y=Y, label=Sample)) +
geom_text() +
xlab(paste("PC1 - ", pca.var.per[1], "%", sep="")) +
ylab(paste("PC2 - ", pca.var.per[2], "%", sep="")) +
theme_bw() +
ggtitle("My PCA Graph")
pca.data <- dades(
X=pca$x[,1],
Y=pca$x[,2])
pca.data
ggplot(data=pca.data, aes(x=X, y=Y, label=Sample)) +
geom_text() +
xlab(paste("PC1 - ", pca.var.per[1], "%", sep="")) +
ylab(paste("PC2 - ", pca.var.per[2], "%", sep="")) +
theme_bw() +
ggtitle("My PCA Graph")
pca.data <- dades
pca.data
ggplot(data=pca.data, aes(x=X, y=Y, label=Sample)) +
geom_text() +
xlab(paste("PC1 - ", pca.var.per[1], "%", sep="")) +
ylab(paste("PC2 - ", pca.var.per[2], "%", sep="")) +
theme_bw() +
ggtitle("My PCA Graph")
x <- read.table(file = "dades.txt", header = TRUE)
head(x)
pca.data <- dades
PCA <- function(data, num){
data <- data[,-num]
prcomp <- prcomp(data, center = TRUE,scale. = TRUE)
library(ggplot2)
df <- cbind(data, prcomp$x[,1:2])
ggplot(df, aes(PC1, PC2, col = data[,num], fill = data[,num])) +
stat_ellipse(geom="polygon", col="black", alpha = .4, type="norm") +
geom_point(shape=21, col ="black")
}
PCA(dades,1)
PCA(dades,1)
PCA(dades,1)
## now make a fancy looking plot that shows the PCs and the variation:
library(ggplot2)
x <- read.table(file = "dades.txt", header = TRUE)
head(x)
pca.data <- dades
PCA <- function(data, num){
data <- data[,-num]
prcomp <- prcomp(data, center = TRUE,scale. = TRUE)
library(ggplot2)
df <- cbind(data, prcomp$x[,1:2])
ggplot(df, aes(PC1, PC2, col = data[,num], fill = data[,num])) +
stat_ellipse(geom="polygon", col="black", alpha = .4, type="norm") +
geom_point(shape=21, col ="black")
}
PCA(dades,1)
View(dades)
dades <- read.delim("C:/Users/Usuario/Desktop/PAUP/dades.txt", header=FALSE)
View(dades)
x <- read.table(file = "dades.txt", header = TRUE)
head(x)
pca.data <- dades
PCA <- function(data, num){
data <- data[,-num]
prcomp <- prcomp(data, center = TRUE,scale. = TRUE)
library(ggplot2)
df <- cbind(data, prcomp$x[,1:2])
ggplot(df, aes(PC1, PC2, col = data[,num], fill = data[,num])) +
stat_ellipse(geom="polygon", col="black", alpha = .4, type="norm") +
geom_point(shape=21, col ="black")
}
PCA(dades,1)
PCA(dades,0)
PCA(dades,1)
PCA <- function(data, num){
data <- data[,-num]
prcomp <- prcomp(data, center = TRUE,scale. = TRUE)
library(ggplot2)
df <- cbind(data, prcomp$x[,1:2])
ggplot(df, aes(PC1, PC2, col = data[,num], fill = data[,num])) +
stat_ellipse(geom="polygon", col="black", alpha = .4, type="norm") +
geom_point(shape=21, col ="black")
rownames = labels()
}
PCA(dades,1)
PCA <- function(data, num){
data <- data[,-num]
prcomp <- prcomp(data, center = TRUE,scale. = TRUE)
library(ggplot2)
df <- cbind(data, prcomp$x[,1:2])
ggplot(df, aes(PC1, PC2, col = data[,num], fill = data[,num])) +
stat_ellipse(geom="polygon", col="black", alpha = .4, type="norm") +
geom_point(shape=21, col ="black")
}
PCA(dades,1)
PCA <- function(data, num){
data <- data[,-num]
prcomp <- prcomp(data, center = TRUE,scale. = TRUE)
library(ggplot2)
df <- cbind(data, prcomp$x[,1:2])
ggplot(df, aes(PC1, PC2, col = data[,num], fill = data[,num])) +
stat_ellipse(geom="polygon", col="black", alpha = .4, type="norm", label = TRUE, label.size = 3) +
geom_point(shape=21, col ="black")
}
PCA(dades,1)
PCA <- function(data, num){
data <- data[,-num]
prcomp <- prcomp(data, center = TRUE,scale. = TRUE)
library(ggplot2)
df <- cbind(data, prcomp$x[,1:2])
ggplot(df, aes(PC1, PC2, col = data[,num], fill = data[,num], label = TRUE, label.size = 3)) +
stat_ellipse(geom="polygon", col="black", alpha = .4, type="norm") +
geom_point(shape=21, col ="black")
}
PCA(dades,1)
PCA <- function(data, num){
data <- data[,-num]
prcomp <- prcomp(data, center = TRUE,scale. = TRUE)
library(ggplot2)
df <- cbind(data, prcomp$x[,1:2])
ggplot(df, aes(PC1, PC2, col = data[,num], fill = data[,num], rownames = data[,num])) +
stat_ellipse(geom="polygon", col="black", alpha = .4, type="norm") +
geom_point(shape=21, col ="black")
}
PCA(dades,1)
PCA <- function(data, num){
data <- data[,-num]
prcomp <- prcomp(data, center = TRUE,scale. = TRUE)
library(ggplot2)
df <- cbind(data, prcomp$x[,1:2])
ggplot(df, aes(PC1, PC2, col = data[,num], fill = data[,num],labels=rownames(data[,num]))) +
stat_ellipse(geom="polygon", col="black", alpha = .4, type="norm") +
geom_point(shape=21, col ="black")
}
PCA(dades,1)
## now make a fancy looking plot that shows the PCs and the variation:
library(ggplot2)
x <- read.table(file = "dades.txt", header = TRUE)
head(x)
pca.data <- dades
PCA <- function(data, num){
data <- data[,-num]
prcomp <- prcomp(data, center = TRUE,scale. = TRUE)
library(ggplot2)
df <- cbind(data, prcomp$x[,1:2])
ggplot(df, aes(PC1, PC2, col = data[,num], fill = data[,num],labels=rownames(data[,num]))) +
stat_ellipse(geom="polygon", col="black", alpha = .4, type="norm") +
geom_point(shape=21, col ="black")
}
PCA(dades,1)
PCA <- function(data, num){
data <- data[,-num]
prcomp <- prcomp(data, center = TRUE,scale. = TRUE)
library(ggplot2)
df <- cbind(data, prcomp$x[,1:2])
ggplot(df, aes(PC1, PC2, col = data[,num], fill = data[,num],labels=rownames(data[num]))) +
stat_ellipse(geom="polygon", col="black", alpha = .4, type="norm") +
geom_point(shape=21, col ="black")
}
PCA(dades,1)
PCA <- function(data, num){
data <- data[,-num]
prcomp <- prcomp(data, center = TRUE,scale. = TRUE)
library(ggplot2)
df <- cbind(data, prcomp$x[,1:2])
ggplot(df, aes(PC1, PC2, col = data[,num], fill = data[,num],labels=rownames(data[num,]))) +
stat_ellipse(geom="polygon", col="black", alpha = .4, type="norm") +
geom_point(shape=21, col ="black")
}
PCA(dades,1)
pca.data <- dades
PCA <- function(data, num){
data <- data[,-num]
prcomp <- prcomp(data, center = TRUE,scale. = TRUE)
library(ggplot2)
df <- cbind(data, prcomp$x[,1:2])
ggplot(df, aes(PC1, PC2, col = data[,num], fill = data[,num],labels=rownames(data[num,]))) +
stat_ellipse(geom="polygon", col="black", alpha = .4, type="norm") +
geom_point(shape=21, col ="black")
}
PCA(dades,1)
PCA <- function(data, num){
data <- data[,-num]
prcomp <- prcomp(data, center = TRUE,scale. = TRUE)
library(ggplot2)
df <- cbind(data, prcomp$x[,1:2])
ggplot(df, aes(PC1, PC2, col = data[,num], fill = data[,num])) +
stat_ellipse(geom="polygon", col="black", alpha = .4, type="norm") +
geom_point(shape=21, col ="black")
}
PCA(dades,1)
PCA <- function(data, num){
prcomp <- prcomp(data, center = TRUE,scale. = TRUE)
library(ggplot2)
df <- cbind(data, prcomp$x[,1:2])
ggplot(df, aes(PC1, PC2, col = data[,num], fill = data[,num]),labels=rownames(data[num,]) +
stat_ellipse(geom="polygon", col="black", alpha = .4, type="norm") +
geom_point(shape=21, col ="black")
}
PCA(dades,1)
pca.data <- dades
PCA <- function(data, num){
prcomp <- prcomp(data, center = TRUE,scale. = TRUE)
library(ggplot2)
df <- cbind(data, prcomp$x[,1:2])
ggplot(df,labels=rownames(data[,num], aes(PC1, PC2, col = data[,num], fill = data[,num])) +
stat_ellipse(geom="polygon", col="black", alpha = .4, type="norm") +
geom_point(shape=21, col ="black")
}
PCA(dades,1)
PCA <- function(data, num){
prcomp <- prcomp(data, center = TRUE,scale. = TRUE)
library(ggplot2)
df <- cbind(data, prcomp$x[,1:2],labels=rownames(data[,num])
ggplot(df, aes(PC1, PC2, col = data[,num], fill = data[,num])) +
stat_ellipse(geom="polygon", col="black", alpha = .4, type="norm") +
geom_point(shape=21, col ="black")
}
PCA(dades,1)
PCA <- function(data, num){
data <- data[,-num]
prcomp <- prcomp(data, center = TRUE,scale. = TRUE)
library(ggplot2)
df <- cbind(data, prcomp$x[,1:2],labels=rownames(data[,num])
ggplot(df, aes(PC1, PC2, col = data[,num], fill = data[,num]))) +
stat_ellipse(geom="polygon", col="black", alpha = .4, type="norm") +
geom_point(shape=21, col ="black")
}
PCA(dades,1)
library(tidyverse)
install.packages(tidyverse)
library
library(tidyverse)
PCA <- function(data, num){
data <- data[,-num]
prcomp <- prcomp(data, center = TRUE,scale. = TRUE)
library(ggplot2)
df <- cbind(data, prcomp$x[,1:2])
ggplot(df, aes(PC1, PC2, col = data[,num], fill = data[,num])) +
stat_ellipse(geom="polygon", col="black", alpha = .4, type="norm") +
geom_point(shape=21, col ="black")
}
PCA(dades,1)
PCA <- function(data, num){
data <- data[,-num]
prcomp <- prcomp(data, center = TRUE,scale. = TRUE)
library(ggplot2)
df <- cbind(data, prcomp$x[,1:2])
ggplot(df, labels = rownames(data[,num]) aes(PC1, PC2, col = data[,num], fill = data[,num])) +
stat_ellipse(geom="polygon", col="black", alpha = .4, type="norm") +
geom_point(shape=21, col ="black")
}
PCA(dades,1)
PCA <- function(data, num){
data <- data[,-num]
prcomp <- prcomp(data, center = TRUE,scale. = TRUE)
library(ggplot2)
df <- cbind(data, prcomp$x[,1:2])
ggplot(df, labels = rownames(data[,num]), aes(PC1, PC2, col = data[,num], fill = data[,num])) +
stat_ellipse(geom="polygon", col="black", alpha = .4, type="norm") +
geom_point(shape=21, col ="black")
}
PCA(dades,1)
PCA <- function(data, num){
data <- data[,-num]
prcomp <- prcomp(data, center = TRUE,scale. = TRUE)
library(ggplot2)
df <- cbind(data, prcomp$x[,1:2])
ggplot(df, labels = rownames(data[,num]), aes(PC1, PC2, col = data[,num], fill = data[,num], labels = TRUE)) +
stat_ellipse(geom="polygon", col="black", alpha = .4, type="norm") +
geom_point(shape=21, col ="black")
}
PCA(dades,1)
library(readxl)
library(readxl)
PCA <- function(data, num){
data <- data[,-num]
prcomp <- prcomp(data, center = TRUE,scale. = TRUE)
library(ggplot2)
df <- cbind(data, prcomp$x[,1:2])
ggplot(df, labels = rownames(data[,num]), aes(PC1, PC2, col = data[,num], fill = data[,num], labels = TRUE)) +
stat_ellipse(geom="polygon", col="black", alpha = .4, type="norm") +
geom_point(shape=21, col ="black")
}
respca2 <- PCA(dades,1)
print(respca2)
library(factoextra)
get_pca(respca2) #Extrae la información sobre las variables.
get_pca_var(respca2) #Extrae la información sobre las variables.
get_pca_ind(respca2) #Extrae la información sobre las observaciones.
fviz_eig(respca2) #visualizar eigenvalores (scree plot)
fviz_screeplot(respca2) #visualizar eigenvalores (scree plot)
fviz_pca_ind(respca2) #Representación de observaciones sobre componentes principales.
fviz_pca_ind(respca2,
col.ind = "cos2", # Color by the quality of representation
gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),
repel = FALSE     # Avoid text overlapping
)
fviz_pca_var(respca2) #Representación de variables sobre componentes principales.
library("factoextra")
library(factoextra)
iinstall.packages("factoextra")
iinstall.packages(factoextra)
PCA <- function(data, num){
data <- data[,-num]
prcomp <- prcomp(data, center = TRUE,scale. = TRUE)
library(ggplot2)
df <- cbind(data, prcomp$x[,1:2])
ggplot(df, aes(PC1, PC2, col = data[,num], fill = data[,num], labels = TRUE)) +
stat_ellipse(geom="polygon", col="black", alpha = .4, type="norm") +
geom_point(shape=21, col ="black")
}
respca2 <- PCA(dades,1)
print(respca2)
